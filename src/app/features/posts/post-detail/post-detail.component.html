<!--
    pdf
    url: !mobile
    * pdf: !safari (google) !mobile (google)
    google: slow
 -->

<!-- 
    docx
    url: download
    google: :)
    * office: :) mobile(not responsive)
 -->

<!-- 
    pptx
    google: :)
    * office: :)
 -->

<!-- 
    xlsx
    google: show like img
    * office: 
 -->

 <main class="flex_start gap-1 flex_wrap">
    <!-- Card -->
    <div class="left-section">
        <button mat-raised-button>
            <mat-icon>arrow_back</mat-icon>
            <span>Volver a resultados</span>
        </button>

        <mat-card class="card" *ngIf="!!post">
            <div class="flex_column gap-1">
                <div class="flex_between_center">
                    <div>
                        <div class="flex_start_center gap-05 time-data">
                            <mat-icon>schedule</mat-icon>
                            <span>
                                Hace {{ post.created_at|timeAgo }} por
                                {{ post.user|getUsername }}
                                <br>
                                <span>
                                    {{ post.user.education?.name }}
                                </span>
                                <span *ngIf="post.user.education?.name && post.user.institution?.name">
                                    en {{ post.user.institution?.name }}
                                </span>
                            </span>
                        </div>
                    </div>
                    <button mat-icon-button>
                        <mat-icon *ngIf="!!post.is_liked">favorite</mat-icon>
                        <mat-icon *ngIf="!!!post.is_liked">favorite_outline</mat-icon>
                    </button>
                </div>
        
                <mat-card-title>{{ post.title }}</mat-card-title>
                <div>{{ post.description }}</div>
        
                <mat-chip-list class="flex_start_center flex_wrap">
                    <mat-chip class="academic-level-tag">
                        <span>Nivel acad√©mico: {{ post.academic_level.name }}</span>
                    </mat-chip>
                    <mat-chip class="subject-tag">
                        <span>Asignatura: {{ post.axis.subject.name }}</span>
                    </mat-chip>
                    <mat-chip class="axis-tag">
                        <span>Eje: {{ post.axis.name }}</span>
                    </mat-chip>
                </mat-chip-list>
        
                <div class="flex_start_center gap-05">
                    <mat-icon>description</mat-icon>
                    <span>{{ post.suporting_material?.length ?? 0 + 1 }} Documentos</span>
                </div>
                <div class="flex_column gap-05">
                    <div class="document no-select" (click)="viewDocument(post.main_file)" matRipple>
                        <span>{{ post.main_file|getDocName }}</span>

                        <a [href]="post.main_file" target="_blank">
                            <button
                                mat-raised-button
                                class="download-button {{ post.main_file|getDocType:docTypes }}-button">
                                    <span>.{{ post.main_file|getDocType:docTypes }}</span>
                                    <mat-icon>download</mat-icon>
                            </button>
                        </a>
                    </div>
                    <div class="document" unselectable="on" *ngFor="let doc of post.suporting_material" (click)="viewDocument(doc)" matRipple>
                        <span>{{ doc|getDocName }}</span>

                        <a [href]="doc">
                            <button
                                mat-raised-button
                                class="download-button {{ doc|getDocType:docTypes }}-button">
                                    <span>.{{ doc|getDocType:docTypes }}</span>
                                    <mat-icon>download</mat-icon>
                            </button>
                        </a>
                    </div>
                </div>

                <div class="flex_between_center">
                    <div class="flex_start_center gap-05">
                        <mat-icon>favorite</mat-icon>
                        <span>{{ post.likes }} Me gusta</span>
                    </div>
                    <div class="flex_start_center gap-05">
                        <mat-icon>cloud_download</mat-icon>
                        <span>{{ post.downloads }} Descargas</span>
                    </div>
                </div>
            </div>
        </mat-card>
    </div>

    <!-- Doc preview -->
    <ngx-doc-viewer
        *ngIf="!isLoading"
        class="doc-preview"
        [url]="currentDocUrl"
        [viewer]="currentViewer"
    ></ngx-doc-viewer>
</main>